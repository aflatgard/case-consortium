<!DOCTYPE HTML>

<html>
{{ partial "header.html" . }}
<body id="tops" class="left-sidebar">
<div id="page-wrapper">
	<!--Header Section-->
	<div id="header-wrapper">
	{{ partial "header_section.html" . }}
	</div>
	<!-- End Header Section-->

<!-- Main -->
<div id="main-wrapper">
<div class="container">
<h2>Browse Cases</h2>
<p>Some instructions on how best to browse cases.</p>
<div class="row 200%">
  <div class="12u 12u$(medium)">
        <form class="form-inline" role="search">
            <div class="input-group">
                <input id="q" type="text" class="form-control" placeholder="search" />
                <div class="input-group-btn"></div>
            </div>
        </form>
        <div class="12u 12u$(medium)" id="search-results"></div>
    </div>
<div class="4u 12u$(medium)">
<!-- Facets -->
<div id="sidebar">

            <div id="facets"></div>

</div>
<!-- End Facets -->
</div>
<div class="8u 12u$(medium) important(medium)">
<!-- Content -->
<div id="content">


<div id="order-by"></div>
<table class="alt" id="results"></table>

</div> 
<!-- End Content -->
</div>
</div>
</div>
</div>
</div>

			<!-- Footer -->
		
			</div>

</header>

                {{ partial "footer.html" . }}

            <script data-export="true" data-file-extension="js" id="facetize">
            jQuery(document).ready(function(){
                    $.getJSON('/js/api/cases.json').success(function(cases){
                            window.Cases = cases;
                        }).error(function(){
                            alert('There was a problem loading the cases.')
                        }).complete(function(){
                          function setTableHeaders(){
                            jQuery('#results').prepend('<thead>' +
                                                        '<tr>' +
                                                            '<th>Case Number</th>' +
                                                            '<th>Title</th>' +
                                                            '<th>Topics</th>' +
                                                        '</tr>' +
                                                      '</thead>');
                            }
                            window.unescapeHtml = function(){
                              jQuery('.unescape').each(function(){
                                  var text = jQuery(this).text();
                                  jQuery(this).html(text);
                              });
                            }    

                            var item_template = 
                            '<tr class="item">' +
                              '<td id="case-id-<%= obj.id %>"><div class="desc hidden"><%= obj.description %></div>' +
                              '<span class="unescape"><%= obj.case_number %></span></td>' +
                              '<td><a href="<%= obj.slug %>">'+
                              '<h4 class="unescape"> <%= obj.title %></h4> </a></td>' + 
                              '<td class="item-topics"><% for(var topic in obj.topics)' +
                              '{ %> <%= obj.topics[topic] %><span class="comma-sep">,</span> <% } %></td>' +
                            '</tr>';
                            settings = { 
                              items            : Cases.cases,
                              facets           : { 
                                                  'topics': 'Filter by Topic',
                                                  'related_cases': 'Related Cases',
                                                  'category': 'Category'
                              },  
                              resultSelector   : '#results',
                              facetSelector    : '#facets',
                              resultTemplate   : item_template,
                              paginationCount  : 10,
                              orderByOptions   : {'title': 'Title', 'case_number': 'Case Number'},
                              bottomContainer    : '<div class="bottom-container"></div>',
                              //facetSortOption  : {'continent': ["North America", "South America"]}
                            }   

                            // use them!
                            jQuery.facetelize(settings);
                            setTableHeaders();
                            unescapeHtml();

                            jQuery('.orderbyitem')
                              .add(jQuery('.facetitem'))
                              .add(jQuery('.deselectstartover'))
                              .add(jQuery('#showmorebutton'))
                              .on('click', function(){
                                setTableHeaders();
                                unescapeHtml();
                            })

                        })
              });
            </script>
    </body>

</html>

